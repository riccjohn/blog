---
// Theme toggle component
---

<button
    id="theme-toggle"
    aria-label="Toggle theme"
    title="Toggle dark/light theme"
    class="bg-bg-tertiary border-border-default text-text-secondary hover:border-accent-primary hover:text-accent-primary flex cursor-pointer items-center justify-center rounded border p-2 transition-all duration-200"
>
    <svg
        class="sun h-5 w-5 dark:hidden"
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
    >
        <circle cx="10" cy="10" r="4" fill="currentColor"></circle>
        <line
            x1="10"
            y1="2"
            x2="10"
            y2="4"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"></line>
        <line
            x1="10"
            y1="16"
            x2="10"
            y2="18"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"></line>
        <line
            x1="18"
            y1="10"
            x2="16"
            y2="10"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"></line>
        <line
            x1="4"
            y1="10"
            x2="2"
            y2="10"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"></line>
        <line
            x1="15.66"
            y1="4.34"
            x2="14.24"
            y2="5.76"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"></line>
        <line
            x1="5.76"
            y1="14.24"
            x2="4.34"
            y2="15.66"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"></line>
        <line
            x1="15.66"
            y1="15.66"
            x2="14.24"
            y2="14.24"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"></line>
        <line
            x1="5.76"
            y1="5.76"
            x2="4.34"
            y2="4.34"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"></line>
    </svg>
    <svg
        class="moon hidden h-5 w-5 dark:block"
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="currentColor"
        xmlns="http://www.w3.org/2000/svg"
    >
        <path
            d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
        ></path>
    </svg>
</button>

<script is:inline>
    // Initialize theme on page load
    const initTheme = () => {
        const storedTheme = localStorage.getItem('theme-preference')
        const systemPrefersDark = window.matchMedia(
            '(prefers-color-scheme: dark)'
        ).matches
        const theme = storedTheme || (systemPrefersDark ? 'dark' : 'light')
        if (theme === 'dark') {
            document.documentElement.classList.add('dark')
        } else {
            document.documentElement.classList.remove('dark')
        }
    }

    // Set theme and save preference
    const setTheme = (theme) => {
        if (theme === 'dark') {
            document.documentElement.classList.add('dark')
        } else {
            document.documentElement.classList.remove('dark')
        }
        localStorage.setItem('theme-preference', theme)
    }

    // Get current theme
    const getTheme = () => {
        return document.documentElement.classList.contains('dark')
            ? 'dark'
            : 'light'
    }

    // Toggle theme
    const toggleTheme = () => {
        const currentTheme = getTheme()
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark'
        setTheme(newTheme)
    }

    // Initialize on load
    initTheme()

    // Add event listener to toggle button
    const toggle = document.getElementById('theme-toggle')
    if (toggle) {
        toggle.addEventListener('click', toggleTheme)
    }

    // Listen for system preference changes (optional enhancement)
    window
        .matchMedia('(prefers-color-scheme: dark)')
        .addEventListener('change', (e) => {
            // Only auto-switch if user hasn't set a preference
            if (!localStorage.getItem('theme-preference')) {
                setTheme(e.matches ? 'dark' : 'light')
            }
        })
</script>
